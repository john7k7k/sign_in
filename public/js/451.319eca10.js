"use strict";(self["webpackChunkwebpage1"]=self["webpackChunkwebpage1"]||[]).push([[451],{9451:function(i,s,e){e.d(s,{Z:function(){return U}});var t=e(3396),n=e(7139),a=e(9242),o=e(870),h=e(11),l=e(6572),c=e(8694),r=e(6145),g=e(8777);const d={class:"ChoseFishBox"},u={class:"ChoseFishItem1"},f={class:"ChoseFishLabel"},m={class:"ChoseFishItem2"},p={class:"configureBackdrop"},I={class:"startBox"},w={class:"startBoxItem1"},C={class:"startBoxItem2"},x={class:"startWordCSS"},v={key:0,class:"menu-container"},W={class:"box"},k={class:"tital"},S={class:"resultTital"},F={class:"Resultsword"};function _(i,s,e,_,b,y){return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.wy)((0,t._)("div",d,[(0,t._)("div",u,[(0,t._)("label",f,(0,n.zw)(b.ChosefishWord[b.languageIndex]),1),(0,t.Wm)(o.T,{color:"white",class:"ChoseFishLabel",icon:"mdi mdi-close-thick",variant:"text",onClick:s[0]||(s[0]=i=>b.isChoseFish=!1)})]),(0,t._)("div",m,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(this.Chfishnicknames,((i,s)=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(h._,{key:i,class:(0,n.C_)(0==b.fishStates[s]?"ChoseFishcard":"ControledFishcard"),onClick:s=>y.selectFish(i)},{default:(0,t.w5)((()=>[(0,t.Wm)(c.f,{class:"ChoseFishImg",height:"80%",src:b.fishurl[s]},null,8,["src"]),(0,t.Wm)(l.E,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(i),1)])),_:2},1024)])),_:2},1032,["class","onClick"])),[[a.F8,0==this.languageIndex]]))),128)),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(this.Enfishnicknames,((i,s)=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(h._,{key:i,class:(0,n.C_)(0==b.fishStates[s]?"ChoseFishcard":"ControledFishcard"),onClick:s=>y.selectFish(i)},{default:(0,t.w5)((()=>[(0,t.Wm)(c.f,{class:"ChoseFishImg",height:"80%",src:b.fishurl[s]},null,8,["src"]),(0,t.Wm)(l.E,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(i),1)])),_:2},1024)])),_:2},1032,["class","onClick"])),[[a.F8,1==this.languageIndex]]))),128))])],512),[[a.F8,b.isChoseFish]]),(0,t.wy)((0,t._)("div",p,[(0,t._)("div",I,[(0,t._)("div",w,[(0,t._)("div",{class:"startTital",style:(0,n.j5)({fontSize:1===b.languageIndex?"30px":"40px"})},(0,n.zw)(b.titalWord[b.languageIndex]),5)]),(0,t._)("div",C,[(0,t._)("div",x,[(0,t._)("p",null,(0,n.zw)(b.starttitalWord[b.languageIndex][0]),1),(0,t._)("p",null,(0,n.zw)(b.starttitalWord[b.languageIndex][1]),1)]),(0,t.Wm)(o.T,{class:"startBtnCSS",onClick:y.toggleMenu,variant:"flat"},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"startBtnCSScontainer",style:(0,n.j5)({fontSize:1===b.languageIndex?"16px":"19px"})},(0,n.zw)(b.languageWord[b.languageIndex]),5)])),_:1},8,["onClick"]),b.isMenuVisible?((0,t.wg)(),(0,t.iD)("div",v,[(0,t.Wm)(r.i,null,{default:(0,t.w5)((()=>[(0,t.Wm)(g.l,{onClick:s[1]||(s[1]=i=>y.selectLanguage("zh"))},{default:(0,t.w5)((()=>[(0,t.Uk)("中文")])),_:1}),(0,t.Wm)(g.l,{onClick:s[2]||(s[2]=i=>y.selectLanguage("en"))},{default:(0,t.w5)((()=>[(0,t.Uk)("English")])),_:1})])),_:1})])):(0,t.kq)("",!0),(0,t.Wm)(o.T,{class:"startBtnCSS",onClick:s[3]||(s[3]=i=>b.isChoseFish=!0),variant:"flat"},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"startBtnCSScontainer",style:(0,n.j5)({fontSize:1===b.languageIndex?"16px":"19px"})},(0,n.zw)(b.ChooseFishWord[b.languageIndex]),5)])),_:1}),(0,t.Wm)(o.T,{class:"startBtnCSS",onClick:y.startVoiceRecognition,variant:"flat"},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"startBtnCSScontainer",style:(0,n.j5)({fontSize:1===b.languageIndex?"16px":"19px"})},(0,n.zw)(b.startBtnWord[b.languageIndex]),5)])),_:1},8,["onClick"])])])],512),[[a.F8,b.showBackdrop]]),(0,t._)("div",W,[(0,t.wy)((0,t.Wm)(o.T,{variant:"text",class:"changeLan",onClick:y.EndVoiceRecognition},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(b.ExitWord[b.languageIndex]),1)])),_:1},8,["onClick"]),[[a.F8,!0]]),(0,t._)("div",k,(0,n.zw)(b.ChooseFishWord[b.languageIndex]),1),(0,t.Wm)(h._,{class:"fishImgSize"},{default:(0,t.w5)((()=>[(0,t.Wm)(c.f,{class:"ChoseFishImg",height:"100%",src:b.fishurl[y.fishImgIndex(b.ChooseFishWord[b.languageIndex])]},null,8,["src"])])),_:1}),(0,t.Wm)(h._,{class:"resultcard"},{default:(0,t.w5)((()=>[(0,t._)("p",S,(0,n.zw)(b.resultWord[b.languageIndex]),1),(0,t._)("div",F,(0,n.zw)(b.command),1)])),_:1}),(0,t.wy)((0,t._)("p",{class:"failresultWord"},(0,n.zw)(b.failword[b.languageIndex]),513),[[a.F8,b.isFail]]),(0,t.Wm)(o.T,{class:(0,n.C_)(["btn-bg text-white",{"ripple-active":b.isListening}]),onClick:y.toggleSpeechRecognition,icon:b.icon,size:"80"},null,8,["onClick","class","icon"]),(0,t.wy)((0,t._)("div",{style:{color:"white"},class:"beginWord"},(0,n.zw)(b.startWord[b.languageIndex]),513),[[a.F8,!b.isListening]]),(0,t.wy)((0,t._)("div",{style:{color:"white"},class:"beginWord"},(0,n.zw)(b.endWord[b.languageIndex]),513),[[a.F8,b.isListening]])])],64)}e(7658),e(2062);var b=e(4161),y={data(){return{showBackdrop:!0,starttitalWord:[["體驗語音操控的樂趣","讓聲音引導機器魚游動！"],["Start experiencing your voice","guiding the robotic fish to swim!"]],startBtnWord:["開始體驗","Start"],selectedfishUID:null,options:[{value:"option1",label:"選項 1"},{value:"option2",label:"選項 2"},{value:"option3",label:"選項 3"}],recognition:null,selectedLanguage:["zh-CN","en-US"],recognitionResult:"",command:"",isListening:!1,icon:"mdi mdi-microphone",English:"en-US",languageIndex:0,titalWord:["語音控制","Voice Control"],resultWord:["辨識結果","Identification results"],startWord:["開始辨識","Start recognition"],endWord:["結束辨識","End recognition"],commandWord:["辨識中","Identifying"],failword:["辨識失敗，請再說一次","Recognition failed, please say again"],isFail:!1,isMenuVisible:!1,languageWord:["選擇語言▼","Language▼"],ChooseFishWord:["選擇魚▼","Choose fish▼"],ExitWord:["退出","Exit"],initialChooseFishWord:["選擇魚▼","Choose fish▼"],isChoseFish:!1,fishurl:[],fishUIDs:[],fishStates:[],Chfishnicknames:[],Enfishnicknames:[],ChosefishWord:["選擇想要控制的魚:","Select the fish you want to control:"],countdownTime:30,currentTime:30,timer:null,lang:["ch","eng"]}},mounted(){this.fetchOptions(),this.recognition=new window.webkitSpeechRecognition,this.recognition.lang=this.selectedLanguage[this.languageIndex];const i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);this.recognition.maxSpeechTime=i?500:1e3,this.recognition.onresult=i=>{this.recognitionResult=i.results[0][0].transcript,console.log(this.recognitionResult),this.submit()},this.recognition.onend=()=>{this.isListening&&this.startSpeechRecognition()},this.startSpeechRecognition(),this.endSpeechRecognition()},methods:{toggleSpeechRecognition(){this.isListening?(this.icon="mdi mdi-microphone",this.endSpeechRecognition()):(this.icon="mdi mdi-stop",this.startSpeechRecognition())},startSpeechRecognition(){this.isListening=!0,this.recognition.start(),this.command=this.commandWord[this.languageIndex],this.isFail=!1},endSpeechRecognition(){this.isListening=!1,this.command="",this.recognition.stop(),this.recognition.onresult},changeLanguage(){this.recognition.lang=this.selectedLanguage},submit(){b.Z.post("https://pre.aifish.cc/api/v1/fish/voice",{text:this.recognitionResult,fishUID:this.selectedfishUID,lang:this.lang[this.languageIndex]}).then((({data:i})=>{this.resetTimer(),i.includes("辨識失敗")?(this.isFail=!0,this.command=""):(this.command=i,this.isFail=!1)})).catch((i=>{console.error("Error submitting voice data:",i)}))},handleChange(){this.$emit("change",this.selectedOption)},async fetchOptions(){try{const e=await b.Z.get("https://pre.aifish.cc/api/v1/alivefish?location=002001001",{});if(console.log(e),200===e.status){for(var i=0;i<e.data.length;i++){this.fishStates.push(e.data[i].controlled),this.fishUIDs.push(e.data[i].fishUID);let s=e.data[i].nickName.split(":");this.Chfishnicknames.push(s[0]),this.Enfishnicknames.push(s[1])}for(var s=0;s<this.fishUIDs.length;s++)(function(i){setTimeout(function(){this.fetchImageSource(this.fishUIDs[i])}.bind(this),200*i)}).call(this,s)}}catch(e){console.log(e)}},selectFish(i){let s=null;s=0==this.languageIndex?this.Chfishnicknames.indexOf(i):this.Enfishnicknames.indexOf(i),0==this.fishStates[s]?(this.selectedfishUID=this.fishUIDs[s],this.ChooseFishWord[this.languageIndex]=i,this.isChoseFish=!1):0==this.languageIndex?this.$Message.error("此魚已被控制，不可選擇"):this.$Message.error("This fish has been controlled and cannot be selected")},fishImgIndex(i){let s=null;return s=0==this.languageIndex?this.Chfishnicknames.indexOf(i):this.Enfishnicknames.indexOf(i),s},async fetchImageSource(i){try{const s=await b.Z.get("https://pre.aifish.cc/api/v1/fish/photos/?fishUID="+i,{responseType:"blob"});console.log(s),void 0!==s.data?this.fishurl.push(URL.createObjectURL(s.data)):(i=parseInt(i.toString().slice(-4)),3002===i||3009===i||3013===i?this.fishurl.push(e(9735)("./新花色"+i+".png")):i<=4e3?this.fishurl.push(e(6757)):this.fishurl.push(e(6858)))}catch(s){i=parseInt(i.toString().slice(-4)),3002===i||3009===i||3013===i?this.fishurl.push(e(9735)("./新花色"+i+".png")):i<=4e3?this.fishurl.push(e(6757)):this.fishurl.push(e(6858))}},startVoiceRecognition(){0==this.languageIndex&&"選擇魚▼"!==this.ChooseFishWord[0]||1==this.languageIndex&&"Choose fish▼"!==this.ChooseFishWord[1]?(this.showBackdrop=!1,b.Z.post("https://pre.aifish.cc/api/v1/fish/voicestart",{fishUID:this.selectedfishUID,section:"002001001"},{headers:{Authorization:`Bearer ${this.token}`}}).then((async i=>{console.log(i)})).catch((i=>{console.log(i)})),this.startTimer()):0==this.languageIndex?this.$Message.error("請先選擇要控制的魚"):this.$Message.error("Please select the fish you want to control first")},EndVoiceRecognition(){b.Z.post("https://pre.aifish.cc/api/v1/fish/voicestart",{fishUID:this.selectedfishUID,section:"002001001",end:!0},{headers:{Authorization:`Bearer ${this.token}`}}).then((async i=>{console.log(i),location.reload()})).catch((i=>{console.log(i)}))},traverseAndFlatten(i,s,e){for(var t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var n;n=void 0===e?t:e+"."+t;var a=i[t];"object"===typeof a?this.traverseAndFlatten(a,s,n):s[n]=a}},flatten(i){var s={};return this.traverseAndFlatten(i,s),s},toggleMenu(){this.isMenuVisible=!this.isMenuVisible},selectLanguage(i){this.isMenuVisible=!1,"zh"==i?(this.languageIndex=0,this.languageWord[this.languageIndex]="中文"):"en"==i&&(this.languageIndex=1,this.languageWord[this.languageIndex]="English")},startTimer(){this.timer=setInterval((()=>{this.currentTime>0?this.currentTime--:location.reload()}),1e3)},resetTimer(){this.stopTimer(),this.currentTime=this.countdownTime,this.startTimer()},stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}}},z=e(89);const T=(0,z.Z)(y,[["render",_],["__scopeId","data-v-45e83fd4"]]);var U=T}}]);
//# sourceMappingURL=451.319eca10.js.map