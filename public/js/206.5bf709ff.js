"use strict";(self["webpackChunkwebpage1"]=self["webpackChunkwebpage1"]||[]).push([[206],{4206:function(s,e,i){i.d(e,{Z:function(){return L}});var t=i(3396),n=i(7139),a=i(9242),o=i(870),l=i(11),h=i(6572),r=i(8694),c=i(6145),g=i(8777);const d={class:"ChoseFishBox"},u={class:"ChoseFishItem1"},f={class:"ChoseFishLabel"},m={class:"ChoseFishItem2"},p={class:"configureBackdrop"},x={class:"startBox"},I={class:"startBoxItem1"},w={class:"startBoxItem2"},C={class:"startWordCSS"},S={key:0,class:"menu-container"},v={class:"box"},k={class:"ExitBox"},y={variant:"text",class:"ExitwordCSS"},W={class:"tital"},F={key:0,class:"instructionWordCss"},_={key:1,class:"instructionWordCss"},b={key:2,class:"instructionWordCss"},z={key:3,class:"instructionWordCss"},T={key:4,class:"instructionWordCss"};function U(s,e,i,U,D,E){return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.wy)((0,t._)("div",d,[(0,t._)("div",u,[(0,t._)("label",f,(0,n.zw)(D.ChosefishWord[D.languageIndex]),1),(0,t.Wm)(o.T,{color:"white",class:"ChoseFishLabel",icon:"mdi mdi-close-thick",variant:"text",onClick:e[0]||(e[0]=s=>D.isChoseFish=!1)})]),(0,t._)("div",m,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(this.Chfishnicknames,((s,e)=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(l._,{key:s,class:(0,n.C_)(0==D.fishStates[e]?"ChoseFishcard":"ControledFishcard"),onClick:e=>E.selectFish(s)},{default:(0,t.w5)((()=>[(0,t.Wm)(r.f,{class:"ChoseFishImg",height:"80%",src:D.fishurl[e]},null,8,["src"]),(0,t.Wm)(h.E,{class:"ChoseFishName",style:(0,n.j5)({letterSpacing:1===D.languageIndex?"0px":""})},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(s),1)])),_:2},1032,["style"])])),_:2},1032,["class","onClick"])),[[a.F8,0==this.languageIndex]]))),128)),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(this.Enfishnicknames,((s,e)=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(l._,{key:s,class:(0,n.C_)(0==D.fishStates[e]?"ChoseFishcard":"ControledFishcard"),onClick:e=>E.selectFish(s)},{default:(0,t.w5)((()=>[(0,t.Wm)(r.f,{class:"ChoseFishImg",height:"80%",src:D.fishurl[e]},null,8,["src"]),(0,t.Wm)(h.E,{class:"ChoseFishName",style:(0,n.j5)({letterSpacing:1===D.languageIndex?"0px":""})},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(s),1)])),_:2},1032,["style"])])),_:2},1032,["class","onClick"])),[[a.F8,1==this.languageIndex]]))),128)),(0,t.wy)((0,t.Wm)(l._,{class:"empty"},{default:(0,t.w5)((()=>[(0,t.Wm)(r.f,{class:"ChoseFishImg",height:"80%",src:D.fishurl[0]},null,8,["src"]),(0,t.Wm)(h.E,{class:"ChoseFishName",style:(0,n.j5)({letterSpacing:1===D.languageIndex?"0px":""})},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(),1)])),_:1},8,["style"])])),_:1},512),[[a.F8,D.isOdd]])])],512),[[a.F8,D.isChoseFish]]),(0,t.wy)((0,t._)("div",p,[(0,t._)("div",x,[(0,t._)("div",I,[(0,t._)("div",{class:"startTital",style:(0,n.j5)({fontSize:1===D.languageIndex?"30px":"40px"})},(0,n.zw)(D.titalWord[D.languageIndex]),5)]),(0,t._)("div",w,[(0,t._)("div",C,[(0,t._)("p",null,(0,n.zw)(D.starttitalWord[D.languageIndex][0]),1),(0,t._)("p",null,(0,n.zw)(D.starttitalWord[D.languageIndex][1]),1)]),(0,t.Wm)(o.T,{class:"startBtnCSS",onClick:E.toggleMenu,variant:"flat"},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"startBtnCSScontainer",style:(0,n.j5)({fontSize:1===D.languageIndex?"16px":"19px",letterSpacing:1===D.languageIndex?"0px":""})},(0,n.zw)(D.languageWord[D.languageIndex]),5)])),_:1},8,["onClick"]),D.isMenuVisible?((0,t.wg)(),(0,t.iD)("div",S,[(0,t.Wm)(c.i,null,{default:(0,t.w5)((()=>[(0,t.Wm)(g.l,{onClick:e[1]||(e[1]=s=>E.selectLanguage("zh"))},{default:(0,t.w5)((()=>[(0,t.Uk)("中文")])),_:1}),(0,t.Wm)(g.l,{onClick:e[2]||(e[2]=s=>E.selectLanguage("en"))},{default:(0,t.w5)((()=>[(0,t.Uk)("English")])),_:1})])),_:1})])):(0,t.kq)("",!0),(0,t.Wm)(o.T,{class:"startBtnCSS",onClick:e[3]||(e[3]=s=>D.isChoseFish=!0),variant:"flat"},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"startBtnCSScontainer",style:(0,n.j5)({fontSize:1===D.languageIndex?"16px":"19px",letterSpacing:1===D.languageIndex?"0px":""})},(0,n.zw)(D.ChooseFishWord[D.languageIndex]),5)])),_:1}),(0,t.Wm)(o.T,{class:"BlueBtnCSS",onClick:E.startVoiceRecognition,variant:"flat"},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"BlueBtnCSScontainer",style:(0,n.j5)({fontSize:1===D.languageIndex?"16px":"19px",letterSpacing:1===D.languageIndex?"0px":""})},(0,n.zw)(D.startBtnWord[D.languageIndex]),5)])),_:1},8,["onClick"])])])],512),[[a.F8,D.showBackdrop]]),(0,t._)("div",v,[(0,t._)("div",k,[(0,t.Wm)(o.T,{icon:"mdi mdi-exit-to-app",size:"40",class:"Exitbtn-bg text-white",onClick:E.EndVoiceRecognition},null,8,["onClick"]),(0,t._)("p",y,(0,n.zw)(D.ExitWord[D.languageIndex]),1)]),(0,t._)("div",W,(0,n.zw)(D.ChooseFishWord[D.languageIndex]),1),(0,t.Wm)(l._,{class:"fishImgSize"},{default:(0,t.w5)((()=>[(0,t.Wm)(r.f,{class:"ChoseFishImg",height:"100%",src:D.fishurl[E.fishImgIndex(D.ChooseFishWord[D.languageIndex])]},null,8,["src"])])),_:1}),(0,t.Wm)(l._,{class:"resultcard"},{default:(0,t.w5)((()=>[(0,t._)("p",{class:"resultTital",style:(0,n.j5)({fontSize:1===D.languageIndex?"22px":"",letterSpacing:1===D.languageIndex?"0px":""})},(0,n.zw)(D.resultWord[D.languageIndex]),5),(0,t._)("div",{class:"Resultsword",style:(0,n.j5)(E.commandStyle)},(0,n.zw)(D.command),5),(0,t._)("p",{class:"failresultWord",style:(0,n.j5)(E.failStyle)},(0,n.zw)(D.failword[D.languageIndex]),5),0===D.languageIndex?((0,t.wg)(),(0,t.iD)("p",F,"指令表:")):(0,t.kq)("",!0),0===D.languageIndex?((0,t.wg)(),(0,t.iD)("p",_,"前進、左轉、右轉、停止、往上、往下、平衡")):(0,t.kq)("",!0),1===D.languageIndex?((0,t.wg)(),(0,t.iD)("p",b,"Commands:")):(0,t.kq)("",!0),1===D.languageIndex?((0,t.wg)(),(0,t.iD)("p",z,"Forward/Go、Turn left、Turn right")):(0,t.kq)("",!0),1===D.languageIndex?((0,t.wg)(),(0,t.iD)("p",T,"Stop、Up、Down、Balance")):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(o.T,{class:(0,n.C_)(["btn-bg text-white",{"ripple-active":D.isListening}]),onClick:E.toggleSpeechRecognition,icon:D.icon,size:"80"},null,8,["onClick","class","icon"]),(0,t.wy)((0,t._)("div",{style:{color:"white"},class:"beginWord"},(0,n.zw)(D.startWord[D.languageIndex]),513),[[a.F8,!D.isListening]]),(0,t.wy)((0,t._)("div",{style:{color:"white"},class:"beginWord"},(0,n.zw)(D.endWord[D.languageIndex]),513),[[a.F8,D.isListening]])])],64)}i(7658),i(2062);var D=i(4161),E={data(){return{showBackdrop:!0,starttitalWord:[["體驗語音操控的樂趣","讓聲音引導機器魚游動！"],["Start experiencing your voice","guiding the robotic fish to swim!"]],startBtnWord:["開始體驗","Start"],selectedfishUID:null,options:[{value:"option1",label:"選項 1"},{value:"option2",label:"選項 2"},{value:"option3",label:"選項 3"}],recognition:null,selectedLanguage:["zh-CN","en-US"],recognitionResult:"",command:"",isListening:!1,icon:"mdi mdi-microphone",English:"en-US",languageIndex:0,titalWord:["語音控制","Voice Control"],resultWord:["辨識結果","Identification results"],startWord:["開始辨識","Start recognition"],endWord:["結束辨識","End recognition"],commandWord:["辨識中","Identifying"],failword:["辨識失敗，請再說一次","Recognition failed,please say again"],isFail:!1,isMenuVisible:!1,languageWord:["語言▼","Language▼"],ChooseFishWord:["魚隻▼","Fish▼"],ExitWord:["退出","Exit"],isChoseFish:!1,fishurl:[],fishUIDs:[],fishStates:[],Chfishnicknames:[],Enfishnicknames:[],ChosefishWord:["選擇想要控制的魚:","Select the fish you want to control:"],countdownTime:30,currentTime:30,timer:null,lang:["ch","eng"],test:!0,resultwordFinal:"",resultTem:"",isSafari:!1,isOdd:!1}},computed:{commandStyle(){return"辨識中"!==this.command&&"Identifying"!==this.command?{color:"#00E676"}:{}},failStyle(){return this.isFail?{visibility:"visible"}:{visibility:"hidden"}}},created(){this.fetchOptions(),this.isOdd=this.Chfishnicknames.length%2==0,this.recognition=new window.webkitSpeechRecognition,this.recognition.lang=this.selectedLanguage[this.languageIndex],this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isSafari?this.recognition.interimResults=!0:this.recognition.maxSpeechTime=1e3,this.recognition.onresult=s=>{for(let e=s.resultIndex;e<s.results.length;e++)s.results[e].isFinal?(console.log("最終結果：",s.results[e][0].transcript),this.resultwordFinal=s.results[e][0].transcript):(console.log("臨時結果：",s.results[e][0].transcript),this.resultTem=s.results[e][0].transcript),this.recognitionResult=s.results[e][0].transcript;this.test||this.submit()},this.recognition.onend=()=>{this.isListening&&this.startSpeechRecognition()},this.startSpeechRecognition()},methods:{readCommands(){navigator.vibrate&&navigator.vibrate(200);const s="您可以使用以下控制指令：前進、後退、左轉、右轉",e=new SpeechSynthesisUtterance(s);window.speechSynthesis.speak(e)},toggleSpeechRecognition(){this.playErrorSound(),this.isListening?(this.icon="mdi mdi-microphone",this.endSpeechRecognition()):(this.icon="mdi mdi-stop",this.startSpeechRecognition())},startSpeechRecognition(){this.isListening=!0,this.recognition.start(),this.command=this.commandWord[this.languageIndex]},endSpeechRecognition(){this.isListening=!1,this.command="",this.recognition.stop()},submit(){D.Z.post("/api/v1/fish/voice",{text:this.recognitionResult,fishUID:this.selectedfishUID,lang:this.lang[this.languageIndex]}).then((({data:s})=>{this.resetTimer(),s.includes("辨識失敗")?(this.playErrorSound(),this.isFail=!0,this.command=""):(this.command=s,this.isFail=!1)})).catch((s=>{console.error("Error submitting voice data:",s)}))},playErrorSound(){const s=new Audio(i(5581));s.play().catch((s=>{console.error("音效播放失敗",s)}))},handleChange(){this.$emit("change",this.selectedOption)},async fetchOptions(){try{const i=await D.Z.get("/api/v1/alivefish?location=002001001",{});if(console.log(i),200===i.status){for(var s=0;s<i.data.length;s++){this.fishStates.push(i.data[s].controlled),this.fishUIDs.push(i.data[s].fishUID);let e=i.data[s].nickName.split(":");this.Chfishnicknames.push(e[0]),this.Enfishnicknames.push(e[1])}for(var e=0;e<this.fishUIDs.length;e++)(function(s){setTimeout(function(){this.fetchImageSource(this.fishUIDs[s])}.bind(this),200*s)}).call(this,e)}}catch(i){console.log(i)}},selectFish(s){let e=null;e=0==this.languageIndex?this.Chfishnicknames.indexOf(s):this.Enfishnicknames.indexOf(s),0==this.fishStates[e]?(this.selectedfishUID=this.fishUIDs[e],this.ChooseFishWord[this.languageIndex]=s,this.isChoseFish=!1):0==this.languageIndex?this.$Message.error("此魚已被控制，不可選擇"):this.$Message.error("This fish has been controlled and cannot be selected")},fishImgIndex(s){let e=null;return e=0==this.languageIndex?this.Chfishnicknames.indexOf(s):this.Enfishnicknames.indexOf(s),e},async fetchImageSource(s){try{const e=await D.Z.get("/api/v1/fish/photos/?fishUID="+s,{responseType:"blob"});console.log(e),void 0!==e.data?this.fishurl.push(URL.createObjectURL(e.data)):(s=parseInt(s.toString().slice(-4)),3002===s||3009===s||3013===s?this.fishurl.push(i(9735)("./新花色"+s+".png")):s<=4e3?this.fishurl.push(i(6757)):this.fishurl.push(i(6858)))}catch(e){s=parseInt(s.toString().slice(-4)),3002===s||3009===s||3013===s?this.fishurl.push(i(9735)("./新花色"+s+".png")):s<=4e3?this.fishurl.push(i(6757)):this.fishurl.push(i(6858))}},startVoiceRecognition(){0==this.languageIndex&&"選擇魚▼"!==this.ChooseFishWord[0]||1==this.languageIndex&&"Choose fish▼"!==this.ChooseFishWord[1]?(this.test=!1,this.showBackdrop=!1,D.Z.post("/api/v1/fish/voicestart",{fishUID:this.selectedfishUID,section:"002001001"},{headers:{Authorization:`Bearer ${this.token}`}}).then((async s=>{console.log(s)})).catch((s=>{console.log(s)})),this.startTimer()):0==this.languageIndex?this.$Message.error("請先選擇要控制的魚"):this.$Message.error("Please select the fish you want to control first")},EndVoiceRecognition(){D.Z.post("/api/v1/fish/voicestart",{fishUID:this.selectedfishUID,section:"002001001",end:!0},{headers:{Authorization:`Bearer ${this.token}`}}).then((async s=>{console.log(s),location.reload()})).catch((s=>{console.log(s)}))},traverseAndFlatten(s,e,i){for(var t in s)if(Object.prototype.hasOwnProperty.call(s,t)){var n;n=void 0===i?t:i+"."+t;var a=s[t];"object"===typeof a?this.traverseAndFlatten(a,e,n):e[n]=a}},flatten(s){var e={};return this.traverseAndFlatten(s,e),e},toggleMenu(){this.isMenuVisible=!this.isMenuVisible},selectLanguage(s){this.isMenuVisible=!1,"zh"==s?(this.languageIndex=0,this.languageWord[this.languageIndex]="中文"):"en"==s&&(this.languageIndex=1,this.languageWord[this.languageIndex]="English"),this.recognition.lang=this.selectedLanguage[this.languageIndex]},startTimer(){this.timer=setInterval((()=>{this.currentTime>0?this.currentTime--:location.reload()}),1e3)},resetTimer(){this.stopTimer(),this.currentTime=this.countdownTime,this.startTimer()},stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}}},B=i(89);const R=(0,B.Z)(E,[["render",U],["__scopeId","data-v-54d7dac3"]]);var L=R},5581:function(s,e,i){s.exports=i.p+"media/error.f809f446.wav"}}]);
//# sourceMappingURL=206.5bf709ff.js.map